function decodeImage(imagePath, callback, index) {	var fs = require('fs');	var page = require('webpage').create();	var fileName = Math.random().toString(36).substring(7)+'_temp.html';	    fs.write(fileName, '<html><body><img src="'+imagePath+'"></body></html>','w');	page.onResourceError = function(err) {		console.log(err);	};		page.onConsoleMessage = function(err) {		console.log(err);	};		var pageManager = function() {		var result = this.evaluateJavaScript(function(){			var img = document.getElementsByTagName("img")[0];            var canvas = document.createElement("canvas");            var ctx = canvas.getContext("2d");            canvas.width = img.width;            canvas.height = img.height;            ctx.drawImage(img, 0, 0);			return canvas.toDataURL("image/png");		});		callback(result,index);		this.close();		fs.remove(fileName);	}    page.open(fileName, pageManager);}function ImageDataResolver(images,resolveCb) {	var manage = {		imagesCount:  images.length,		resultArr: new Array(images.length),		cbCount: 0,		resolveCb: resolveCb,		imageResolver: function(imgB64Data,index) {			this.cbCount++;			this.resultArr[index] = imgB64Data;			if (this.cbCount == this.imagesCount) {				this.resolveCb(this.resultArr);			}		}	};		images.forEach(function(image,index){		decodeImage(image,manage.imageResolver.bind(manage),index);	});	}module.export = ImageDataResolver;// example:// var b64resolver = new ImageDataResolver(['./img_g.png','./img_r.png'],function(result){	// console.log(result);// });